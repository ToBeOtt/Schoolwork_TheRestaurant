@using TheRestaurant.Presentation.Client.ClientServices;
@inject ClientDashboardServices DashboardServices

<MudChart 
    ChartType="ChartType.Bar" 
    ChartSeries="@Series" 
    XAxisLabels="@XAxisLabels.ToArray()" 
    Width="100%" 
    Height="350px">
</MudChart>


@code {
    private List<ChartSeries> Series = new List<ChartSeries>();
    private List<string> XAxisLabels = new List<string>();

    protected override async Task OnInitializedAsync()
    {
        await LoadChartData();
    }

    private async Task LoadChartData()
    {
        try
        {
            var orderStats = await DashboardServices.GetWeeklyOrderStats(DateTime.Now);
            Series.Clear();
            XAxisLabels.Clear();

            // Assuming OrderCountResponse has properties Date and Count
            foreach (var stat in orderStats)
            {
                XAxisLabels.Add(stat.OrderDate); // Convert DateTime to string
                Series.Add(new ChartSeries { Name = "Orders", Data = new double[] { Convert.ToDouble(stat.OrderCount) } });
            }
        }
        catch (Exception ex)
        {
            // Handle exceptions
        }
    }
}

